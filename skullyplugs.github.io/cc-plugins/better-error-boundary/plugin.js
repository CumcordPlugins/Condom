(function(h,a,e,B,N,o,I){"use strict";const U=a.findByDisplayName("ArrowDropDown"),S=a.findByDisplayName("ArrowDropUp");class $ extends e.React.Component{constructor(s){super(s);this.state={open:!1}}render(){const{content:s,openTxt:r,closedTxt:i}=this.props;return e.React.createElement(e.React.Fragment,null,e.React.createElement("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>this.setState({open:!this.state.open})},this.state.open?e.React.createElement(S,null):e.React.createElement(U,null),e.React.createElement("p",null,this.state.open?i:r)),e.React.createElement("div",{style:{display:this.state.open?"block":"none",textAlign:"left",marginLeft:"2%"}},s))}}const{defaultRules:{codeBlock:{react:D}}}=a.findByProps("parse","parseTopic"),k=a.findByDisplayName("Card");var A=({error:t,isReactError:s})=>(I.useNest(o.persist),e.React.createElement(e.React.Fragment,null,e.React.createElement("p",null,"Discord has crashed."),e.React.createElement("p",null,"Short Message: ",e.React.createElement("code",null,t.message)),e.React.createElement(k,{style:{padding:"10px"}},e.React.createElement($,{content:D({content:t.stack,lang:o.persist.ghost.lang},null,{}),openTxt:"Click to reveal full error",closedTxt:"Click to hide full error"}))));const m=/https?:\/\/reactjs\.org\/docs\/error-decoder\.html\?invariant=([0-9]+)(?:[^ ])+/,{iconWrapper:P,clickable:j,icon:z}=a.findByProps("iconWrapper","clickable"),M=a.findByDisplayName("Tooltip"),C=a.findByDisplayName("Spinner",!1);class b extends e.React.Component{constructor(){super();this.state={doCrash:!1}}render(){return e.React.createElement(M,{position:"bottom",text:"Crash Discord",color:"red"},({onMouseEnter:s,onMouseLeave:r})=>e.React.createElement("div",{className:[P,j].join(" "),onMouseEnter:s,onMouseLeave:r,onClick:()=>{h.instead("default",C,(i,d)=>{}),this.setState({doCrash:!this.state.doCrash})}},this.state.doCrash?e.React.createElement(C,null):e.React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:z,viewBox:"0 0 16 16"},e.React.createElement("path",{d:"M9.05.435c-.58-.58-1.52-.58-2.1 0L.436 6.95c-.58.58-.58 1.519 0 2.098l6.516 6.516c.58.58 1.519.58 2.098 0l6.516-6.516c.58-.58.58-1.519 0-2.098L9.05.435zM8 4c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995A.905.905 0 0 1 8 4zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"}))))}}var v=({preview:t,showLocalTime:s})=>{const r=new Date;return(t?`// THIS IS A CRASH LOG PREVIEW LOL
`:"")+`// Discord Version: ${DiscordNative.app.getVersion()}-${DiscordNative.app.getReleaseChannel()}
// Platform: ${DiscordNative.process.platform}
// Crash Time: ${r} ${s?"("+r.toLocaleString()+")":""}

`};const{defaultRules:{codeBlock:{react:F}}}=a.findByProps("parse","parseTopic"),f=a.findByDisplayName("SwitchItem"),J=a.findByDisplayName("FormItem"),O=a.findByDisplayName("RadioGroup"),V=a.findByDisplayName("Card");class H extends e.React.Component{constructor(){super();this.funniError=new Error("This is a funni test error")}regenContent(s,r,{showLocalTime:i}){return(r?v({preview:!0,showLocalTime:i}):"")+s.stack}render(){return e.React.createElement(e.React.Fragment,null,e.React.createElement(f,{note:"Reveals a button in the channel header that crashes the client. (used for testing purposes)",value:o.persist.ghost.showUtils,onChange:()=>{o.persist.store.showUtils=!o.persist.store.showUtils,this.forceUpdate()}},"Show Crash Button"),e.React.createElement(J,{title:"Language Choice"},e.React.createElement(O,{options:[{name:"Javascript (JS)",value:"js"},{name:"PlainText (TXT)",value:"txt"}],onChange:s=>{o.persist.store.lang=s.value,this.forceUpdate()},value:o.persist.ghost.lang}),e.React.createElement(f,{note:"Adds more info to the top of your error. (only shown on saved crash)",value:o.persist.ghost.extInfo,onChange:()=>{o.persist.store.extInfo=!o.persist.store.extInfo,this.forceUpdate()}},"Enable Extra Info"),e.React.createElement(f,{disabled:!o.persist.ghost.extInfo,value:o.persist.ghost.showLocalTime,onChange:()=>{o.persist.store.showLocalTime=!o.persist.store.showLocalTime,this.forceUpdate()}},"Show Local Time"),e.React.createElement(V,{style:{margin:"10px"}},F({content:this.regenContent(this.funniError,o.persist.ghost.extInfo,{showLocalTime:o.persist.ghost.showLocalTime}),lang:o.persist.ghost.lang},null,{}))))}}let x,L,g;var W=t=>({onLoad(){let s;fetch("https://reactjs.org/page-data/docs/error-decoder.html/page-data.json").then(p=>p.json()).then(p=>s=JSON.parse(p.result.data.errorCodesJson.internal.contentDigest));let r,i=!1;const d=a.findByDisplayName("ErrorBoundary",!1),{sizeLarge:y,colorBrand:T}=a.findByProps("sizeLarge"),R=a.findByProps("DropdownSizes");typeof t.persist.ghost?.showUtils!="boolean"&&(t.persist.ghost.showUtils=!1),typeof t.persist.ghost?.lang!="string"&&(t.persist.ghost.lang="js"),typeof t.persist.ghost?.extInfo!="boolean"&&(t.persist.ghost.extInfo=!0),typeof t.persist.ghost?.showLocalTime!="boolean"&&(t.persist.ghost.showLocalTime=!1),L=h.before("componentDidCatch",d.default.prototype,p=>r=p[0]),x=h.after("render",d.default.prototype,(p,l)=>{if(!l.props.note)return;const u=m.test(r.message);let n;if(u){const{message:c,stack:_}=r;if(n=new Error,s[r.message])n.message=s[c];else{const E=c.match(/Minified React error #(\d*);/);E&&E[1]&&(n.message=s[E[1]])}n.message=n.message.replace(/%s\.%s/g,c?.match(/args(\[\]|%5B%5D)=(object|string|array|class|function)/)?.[2]??"%s.%s");const w=_.split(`
    `);w.shift(),n.stack=`${n.message}
    `+w.join(`
    `)}l.props.title="oh noes :o",l.props.note.props.children=[e.React.createElement(A,{error:n??r,isReactError:Boolean(n)})],r&&!i&&(i=!0,l.props.action.props.children[0].props.children="(L) Reload / (R) Relaunch",l.props.action.props.children[0].props.onContextMenu=()=>DiscordNative.app.relaunch(),l.props.action.props.children.push(e.React.createElement(R,{children:"Copy Stack to Clipboard",size:y,color:T,style:{marginLeft:"10px"},onClick:()=>{DiscordNative.clipboard.copy(`\`\`\`${t.persist.ghost.lang}
`+(n??r).stack+"```"),B.showToast({title:"Better Error Boundary",content:"The stack has been copied to your clipboard.",duration:5e3})}})),u&&l.props.action.props.children.push(e.React.createElement(R,{children:"Open React Error Link",size:y,style:{marginLeft:"10px"},onClick:()=>window.open(m.exec(r.message)[0],"_blank")})),l.props.action.props.children.push(e.React.createElement(R,{children:"Save Error to File",size:y,color:T,style:{marginLeft:"10px"},onClick:()=>{const c=document.createElement("a");c.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent((t.persist.ghost.extInfo?v({preview:!1,showLocalTime:t.persist.ghost.showLocalTime}):"")+(n??r).stack)),c.setAttribute("download",`discord-crash-report.${t.persist.ghost.lang}`),c.style.display="none",document.body.appendChild(c),c.click(),document.body.removeChild(c)}})))}),t.persist.on(N.Events.SET,(p,{path:l,value:u})=>{l[0]==="showUtils"&&(u?this.createUtilsPatch():g?.())}),t.persist.ghost.showUtils||this.createUtilsPatch()},createUtilsPatch(){const s=a.findByDisplayName("HeaderBar",!1);g=h.after("default",s,(r,i)=>{try{i.props.children.props.children[1].props.children.props.children[0].some(d=>d.key==="crash")||i.props.children.props.children[1].props.children.props.children[0].push(e.React.createElement(b,{key:"crash"}))}catch{}})},onUnload(){x?.(),L?.(),g?.()},settings:e.React.createElement(H)});return W})(cumcord.patcher,cumcord.modules.webpack,cumcord.modules.common,cumcord.ui.toasts,cumcord.modules.internal.nests,cumcord.pluginData,cumcord.utils);
